#!/bin/bash

TARGET=$1
WORDLIST_DIR="/usr/share/wordlists/seclists"
OUTPUT_DIR="ffuf_results"

mkdir -p $OUTPUT_DIR

# Directory Enumeration
echo "Starting directory enumeration on $TARGET"
ffuf -u $TARGET/FUZZ -w $WORDLIST_DIR/Discovery/Web-Content/directory-list-2.3-medium.txt -o $OUTPUT_DIR/directories.json

# Subdomain Enumeration
echo "Starting subdomain enumeration on $TARGET"
ffuf -u http://FUZZ.$TARGET/ -w $WORDLIST_DIR/Discovery/DNS/subdomains-top1million-110000.txt -o $OUTPUT_DIR/subdomains.json

# VHost Enumeration
echo "Starting virtual host enumeration on $TARGET"
ffuf -u http://$TARGET -H "Host: FUZZ.$TARGET" -w $WORDLIST_DIR/Discovery/DNS/subdomains-top1million-5000.txt -o $OUTPUT_DIR/vhosts.json

echo "Enumeration completed. Results saved in $OUTPUT_DIR"
